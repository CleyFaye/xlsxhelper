var pptxhelper=pptxhelper||{};pptxhelper.Presentation=class{constructor(){this.pptxGen=new PptxGenJS,this.title="",this.width=10,this.height=5.625,this.slides=[]}addSlide(e,t){var i=new pptxhelper.Slide(this,e,t);this.slides.push(i),$(i).on("slide.ready",()=>{this.checkSlideReady()})}download(e){this.isReady()?(void 0===e&&(e=this.title),this.pptxGen.save(e)):$(this).one("pptx.ready",()=>{this.download(e)})}setLayout(e,t,i){void 0===i&&(i="LAYOUT_"+parseInt(e)+"x"+parseInt(t)),this.width=e,this.height=t,this.pptxGen.setLayout({name:i,width:e,height:t})}setCompany(e){return this.pptxGen.setCompany(e),this}setTitle(e){return this.title=e,this.pptxGen.setTitle(e),this}isReady(){var e=!0;return $(this.slides).each(function(){if(!this.isReady())return e=!1,!1}),e}checkSlideReady(){var e=!0;$(this.slides).each(function(){if(!this.isReady())return e=!1,!1}),e&&$(this).trigger("pptx.ready")}},pptxhelper.Slide=class{constructor(e,t,i){this.presentation=e,this.pendingData=0,this.slideGen=this.presentation.pptxGen.addNewSlide(),void 0!==t&&this.loadTemplate(t,i)}isReady(){return 0==this.pendingData}setBackground(e){return this.slideGen.bkgd=e,this}setTextColor(e){this.slideGen.color=e}addImage(e,t,i,a,s,n){if(s instanceof Image)r=this.imageToDataURL(s);else if(void 0!==s.tagName&&"canvas"==s.tagName.toLowerCase())r=s.toDataURL("image/png");else{if("string"!=typeof s||!s.startsWith("data:image/png;"))return++this.pendingData,void this.imageURLToDataURL(s,s=>{--this.pendingData,this.addImage(e,t,i,a,s),0==this.pendingData&&$(this).trigger("slide.ready")});var r=s}this.slideGen.addImage({x:e,y:t,w:i,h:a,data:r,hyperlink:this.createHyperlinkRef(n)})}addText(e,t,i,a,s,n){this.slideGen.addtext(i,{x:e,y:t,font_face:s||"Arial",font_size:n||20,hyperlink:this.createHyperlinkRef(a)})}createHyperlinkRef(e){return void 0!==e?{url:e}:void 0}loadTemplate(e,t){}imageToDataURL(e){if(void 0!==e.dataURL)return e.dataURL;var t=document.createElement("canvas");return t.width=e.naturalWidth,t.height=e.naturalHeight,t.getContext("2d").drawImage(e,0,0),e.dataURL=t.toDataURL("image/png"),e.dataURL}imageURLToDataURL(e,t){var i=new Image;$(i).on("load",()=>{t(this.imageToDataURL(i))}),i.src=e}};var xlsxhelper={};xlsxhelper.Workbook=class{constructor(){this.SheetNames=[],this.Sheets={}}addSheet(e){this.SheetNames.indexOf(e.name);-1==previousIndex&&this.SheetNames.push(e.name),this.Sheets[sheetName]=e}createFile(e,t,i){var a=e,s={bookType:"xls"==e?"biff2":e,bookSST:!1,type:"binary"},n=t?t+"."+a:null,r=XLSX.write(this,s);return i&&i(n,r,"csv"!=e),r}},xlsxhelper.Sheet=class{constructor(e,t){this.name=e,this._disableRangeCalculation=!0;for(var i=0;i<inputArray.length;++i)for(var a=inputArray[i],s=0;s<a.length;++s){var n=a[s];null!=n&&this.setCell(s,i,n)}this._disableRangeCalculation=!1}getCell(e,t){return this[XLSX.utils.encode_cell({c:e,r:t})]}setCell(e,t,i){const a=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d{3})?([+-]\d{2}:?\d{2}|Z)?/;var s=XLSX.utils.encode_cell({c:e,r:t});if(void 0===i)delete this[s];else{if(i instanceof Date)n="d";else if(null!==a.exec(i)){n="d";i=new Date(i)}else if("boolean"==typeof i)n="b";else if("number"==typeof i)n="n";else var n="s";var r={v:i,t:n};this[s]=r}this._updateRange()}_updateRange(){if(!this._disableRangeCalculation){var e=null,t=null,i=null,a=null;for(key in this){if(void 0==this[key].t)return;var s=XLSX.utils.decode_cell(key);if(NaN==s.c||s.r==Nan)return;null===e?(t=e=s.c,a=i=s.r):(s.c<e?e=s.c:s.c>t&&(t=s.c),s.r<i?i=s.r:s.r>a&&(a=s.r))}null===e&&(e=0,t=0,i=0,a=0);var n={s:{c:e,r:i},e:{c:t,r:a}};this["!ref"]=XLSX.utils.encode_range(n)}}};
